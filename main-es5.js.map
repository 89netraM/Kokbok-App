{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/category/category.component.html","webpack:///src/app/category/category.component.ts","webpack:///src/app/details/details.component.ts","webpack:///src/app/details/details.component.html","webpack:///src/app/guards/is-signed-in.guard.ts","webpack:///src/app/guards/is-signed-out.guard.ts","webpack:///src/app/modal/modal-required.directive.ts","webpack:///src/app/modal/modal.component.ts","webpack:///src/app/modal/modal.component.html","webpack:///src/app/routing-state/routing-state.service.ts","webpack:///src/app/settings/settings.component.ts","webpack:///src/app/settings/settings.component.html","webpack:///src/app/sign-in/sign-in.component.ts","webpack:///src/app/sign-in/sign-in.component.html","webpack:///src/app/start/start.component.html","webpack:///src/app/start/start.component.ts","webpack:///src/app/storage/category.ts","webpack:///src/app/storage/item.ts","webpack:///src/app/storage/storage.service.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","routes","path","component","canActivate","children","AppRoutingModule","forRoot","imports","AppComponent","state","location","name","back","hasHistory","selector","templateUrl","styleUrls","AppModule","declarations","providers","bootstrap","$event","preventDefault","stopImmediatePropagation","CategoryComponent","storage","route","isLoading","addingType","category","snapshot","params","getItems","items","item","editingItem","editingTitle","editModal","show","hide","itemDelete","success","filter","x","status","itemRename","type","addingName","addingURL","addModal","addItemDocument","newItem","push","console","error","addItemURL","undefined","value","_editingTitle","_editingTitleBox","addNew","addNewDone","editDone","editDelete","DetailsComponent","converter","_loading","isEditing","getItem","downloadItemText","markdown","article","nativeElement","innerHTML","makeHtml","makeMarkdown","updateDocument","document","execCommand","selection","getSelection","last","current","anchorNode","parentNode","nodeName","selectionNode","selectionOffset","anchorOffset","addImage","files","length","selectedFile","reader","FileReader","addEventListener","focus","setPosition","result","readAsDataURL","toggleEditing","makeHeader","makeBold","makeItalic","makeList","makeBullets","makeImage","addImageDone","imageFileChange","IsSignedInGuard","router","next","isLogedin","navigate","providedIn","IsSignedOutGuard","ModalRequiredDirective","host","_isValid","required","validity","valid","ModalComponent","close","styleDisplay","toArray","every","isValid","visible","emit","RoutingStateService","history","Array","events","subscribe","urlAfterRedirects","pop","SettingsComponent","SignInComponent","signin","StartComponent","getCategories","categories","editingCategory","categoryDelete","categoryRename","addCategory","newCategory","sort","a","b","aName","toLowerCase","bName","Category","created","Date","data","hasOwnProperty","createdDateTime","Item","link","substring","lastIndexOf","StorageService","http","msalAgent","Msal","UserAgentApplication","clientID","tokenReceivedCallback","storeAuthStateInCookie","cacheLocation","redirectUri","acquireToken","errorDesc","token","tokenType","fetchToken","acquireTokenSilent","Scopes","log","acquireTokenPopup","headers","getUser","loginPopup","window","localStorage","clear","URL","getOptions","get","toPromise","response","makeGet","Approot","resopnse","arr","ExtractFromData","cat","createItem","downloadLink","newName","Items","patch","content","put","addItem","post","uploadDocument","uploadSmallDocument","uploadBigDocument","uploadPart","url","blob","index","total","text","Math","min","size","Blob","partSize","i","slice","responseType","linkText","replace","toISOString","scopes","map","base","authority","environment","production","bootstrapModule","err"],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { NgModule } from \"@angular/core\";\nimport { Routes, RouterModule } from \"@angular/router\";\nimport { StartComponent } from \"./start/start.component\";\nimport { IsSignedInGuard } from \"./guards/is-signed-in.guard\";\nimport { SignInComponent } from \"./sign-in/sign-in.component\";\nimport { IsSignedOutGuard } from \"./guards/is-signed-out.guard\";\nimport { SettingsComponent } from \"./settings/settings.component\";\nimport { CategoryComponent } from \"./category/category.component\";\nimport { DetailsComponent } from \"./details/details.component\";\n\nconst routes: Routes = [\n\t{\n\t\tpath: \"\",\n\t\tcomponent: StartComponent,\n\t\tcanActivate: [IsSignedInGuard]\n\t},\n\t{\n\t\tpath: \"sign-in\",\n\t\tcomponent: SignInComponent,\n\t\tcanActivate: [IsSignedOutGuard]\n\t},\n\t{\n\t\tpath: \"settings\",\n\t\tcomponent: SettingsComponent,\n\t\tcanActivate: [IsSignedInGuard]\n\t},\n\t{\n\t\tpath: \"recept/:category\",\n\t\tcanActivate: [IsSignedInGuard],\n\t\tchildren: [\n\t\t\t{\n\t\t\t\tpath: \"\",\n\t\t\t\tcomponent: CategoryComponent\n\t\t\t},\n\t\t\t{\n\t\t\t\tpath: \":name\",\n\t\t\t\tcomponent: DetailsComponent\n\t\t\t}\n\t\t]\n\t}\n];\n\n@NgModule({\n\timports: [RouterModule.forRoot(routes)],\n\texports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { Component } from \"@angular/core\";\nimport { Location } from \"@angular/common\";\nimport { RoutingStateService } from \"./routing-state/routing-state.service\";\n\n@Component({\n\tselector: \"bok-root\",\n\ttemplateUrl: \"./app.component.html\",\n\tstyleUrls: [\"./app.component.scss\"]\n})\nexport class AppComponent {\n\tpublic name: string = \"Kokbok\";\n\n\tpublic get canGoBack(): string {\n\t\treturn this.state.hasHistory() ? \"visible\" : \"hidden\";\n\t}\n\n\tpublic constructor(private state: RoutingStateService, private location: Location) { }\n\n\tpublic back(): void {\n\t\tthis.location.back();\n\t}\n}","<nav>\n\t<button class=\"back\" [style.visibility]=\"canGoBack\" (click)=\"back()\"></button>\n\t<h1 routerLink=\"/\">{{name}}</h1>\n\t<button class=\"settings\"></button>\n</nav>\n<main>\n\t<router-outlet></router-outlet>\n</main>","import { BrowserModule } from \"@angular/platform-browser\";\nimport { AppRoutingModule } from \"./app-routing.module\";\nimport { NgModule } from \"@angular/core\";\nimport { FormsModule } from \"@angular/forms\";\nimport { HttpClientModule } from \"@angular/common/http\";\n\nimport { AppComponent } from \"./app.component\";\nimport { StartComponent } from \"./start/start.component\";\nimport { SignInComponent } from \"./sign-in/sign-in.component\";\nimport { CategoryComponent } from \"./category/category.component\";\nimport { DetailsComponent } from \"./details/details.component\";\nimport { SettingsComponent } from \"./settings/settings.component\";\nimport { StorageService } from \"./storage/storage.service\";\nimport { ModalComponent } from \"./modal/modal.component\";\nimport { ModalRequiredDirective } from \"./modal/modal-required.directive\";\nimport { RoutingStateService } from \"./routing-state/routing-state.service\";\n\n@NgModule({\n\tdeclarations: [\n\t\tAppComponent,\n\t\tStartComponent,\n\t\tSignInComponent,\n\t\tCategoryComponent,\n\t\tDetailsComponent,\n\t\tSettingsComponent,\n\t\tModalComponent,\n\t\tModalRequiredDirective\n\t],\n\timports: [\n\t\tBrowserModule,\n\t\tHttpClientModule,\n\t\tFormsModule,\n\t\tAppRoutingModule\n\t],\n\tproviders: [\n\t\tStorageService,\n\t\tRoutingStateService\n\t],\n\tbootstrap: [\n\t\tAppComponent\n\t]\n})\nexport class AppModule { }","<progress [style.visibility]=\"loading\"></progress>\n<div>\n\t<ng-container *ngFor=\"let item of items\">\n\t\t<ng-container *ngIf=\"item.type === 'url' then internal else external\"></ng-container>\n\t\t<ng-template #internal>\n\t\t\t<a class=\"item\" [href]=\"item.link\" target=\"_blank\">\n\t\t\t\t<span>{{item.name}}</span>\n\t\t\t\t<button (click)=\"$event.preventDefault(); edit(item);\"></button>\n\t\t\t</a>\n\t\t</ng-template>\n\t\t<ng-template #external>\n\t\t\t<button class=\"item\" [routerLink]=\"item.name\">\n\t\t\t\t<span>{{item.name}}</span>\n\t\t\t\t<button (click)=\"$event.stopImmediatePropagation(); edit(item);\"></button>\n\t\t\t</button>\n\t\t</ng-template>\n\t</ng-container>\n\t<a class=\"item new\" (click)=\"addNew()\"></a>\n</div>\n\n<bok-modal #addModal\n           title=\"Nytt recept\"\n           positive=\"Skapa\"\n           negative=\"Avbryt\"\n           (close)=\"addNewDone($event)\">\n\t<input type=\"text\" placeholder=\"Namn\" [(ngModel)]=\"addingName\" modalRequired/>\n\tTyp:\n\t<label><input name=\"type\" type=\"radio\" value=\"doc\" [value]=\"0\" [(ngModel)]=\"addingType\"/> Dokument</label>\n\t<label><input name=\"type\" type=\"radio\" value=\"link\" [value]=\"1\" [(ngModel)]=\"addingType\"/> Länk</label>\n\t<!-- <label>\n\t\t<input type=\"file\" accept=\"image/*\">\n\t\t<button></button>\n\t</label> -->\n\t<input *ngIf=\"addingType === 1\" type=\"url\" placeholder=\"Länk\" [(ngModel)]=\"addingURL\" modalRequired/>\n</bok-modal>\n\n<bok-modal #editModal\n           [title]=\"_editingTitle\"\n           positive=\"Spara\"\n           negative=\"Avbryt\"\n           (close)=\"editDone($event)\">\n\t<input type=\"text\" placeholder=\"Namn\" [(ngModel)]=\"_editingTitleBox\">\n\t<button class=\"delete\" (click)=\"editDelete()\">Ta bort</button>\n</bok-modal>","import { Component, OnInit, ViewChild } from \"@angular/core\";\nimport { Item } from \"../storage/item\";\nimport { StorageService } from \"../storage/storage.service\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { ModalComponent } from \"../modal/modal.component\";\n\n@Component({\n\tselector: \"bok-category\",\n\ttemplateUrl: \"./category.component.html\",\n\tstyleUrls: [\"./category.component.scss\"]\n})\nexport class CategoryComponent implements OnInit {\n\tpublic items: Array<Item>;\n\n\tprivate isLoading: boolean = false;\n\tpublic get loading(): string {\n\t\treturn (this.items === undefined || this.isLoading) ? \"visible\" : \"hidden\";\n\t}\n\n\tprivate category: string;\n\n\t//#region Edit Modal\n\t@ViewChild(\"editModal\")\n\tpublic editModal: ModalComponent;\n\n\tprivate editingItem: Item;\n\tpublic _editingTitle: string;\n\tpublic _editingTitleBox: string;\n\tprivate set editingTitle(value: string) {\n\t\tthis._editingTitle = value;\n\t\tthis._editingTitleBox = value;\n\t}\n\tprivate get editingTitle(): string {\n\t\treturn this._editingTitleBox;\n\t}\n\t//#endregion\n\n\t//#region Add Modal\n\t@ViewChild(\"addModal\")\n\tpublic addModal: ModalComponent;\n\n\tpublic addingName: string;\n\tpublic addingType: number = 0;\n\tpublic addingURL: string;\n\t//#endregion\n\n\tpublic constructor(private storage: StorageService, private route: ActivatedRoute) { }\n\n\tpublic async ngOnInit() {\n\t\tthis.category = this.route.snapshot.params[\"category\"];\n\t\tthis.items = await this.storage.getItems(this.category);\n\t}\n\n\tpublic edit(item: Item): void {\n\t\tthis.editingItem = item;\n\t\tthis.editingTitle = item.name;\n\t\tthis.editModal.show();\n\t}\n\tpublic async editDelete(): Promise<void> {\n\t\t// Delete this.editingID\n\t\tthis.editModal.hide(false);\n\n\t\tthis.isLoading = true;\n\n\t\tconst success: boolean = await this.storage.itemDelete(this.editingItem.id);\n\t\tif (success) {\n\t\t\tthis.items = this.items.filter(x => x.id !== this.editingItem.id);\n\t\t}\n\n\t\tthis.isLoading = false;\n\t}\n\tpublic async editDone(status: boolean): Promise<void> {\n\t\tif (status) {\n\t\t\tthis.isLoading = true;\n\n\t\t\tconst success: boolean = await this.storage.itemRename(this.editingItem.id, this.editingTitle + \".\" + this.editingItem.type);\n\t\t\tif (success) {\n\t\t\t\tthis.editingItem.name = this.editingTitle;\n\t\t\t}\n\n\t\t\tthis.isLoading = false;\n\t\t}\n\t}\n\n\tpublic addNew(): void {\n\t\tthis.addingName = \"\";\n\t\tthis.addingType = 0;\n\t\tthis.addingURL = \"\";\n\n\t\tthis.addModal.show();\n\t}\n\tpublic async addNewDone(status: boolean): Promise<void> {\n\t\tif (status) {\n\t\t\tthis.isLoading = true;\n\n\t\t\tif (this.addingType === 0) {\n\t\t\t\ttry {\n\t\t\t\t\tconst newItem: Item = await this.storage.addItemDocument(this.category, this.addingName);\n\t\t\t\t\tthis.items.push(newItem);\n\t\t\t\t}\n\t\t\t\tcatch (error) {\n\t\t\t\t\tconsole.error(\"Could not add URL:\", error);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.addingType === 1) {\n\t\t\t\ttry {\n\t\t\t\t\tconst newItem: Item = await this.storage.addItemURL(this.category, this.addingName, this.addingURL);\n\t\t\t\t\tthis.items.push(newItem);\n\t\t\t\t}\n\t\t\t\tcatch (error) {\n\t\t\t\t\tconsole.error(\"Could not add URL:\", error);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.isLoading = false;\n\t\t}\n\t}\n}","import { Component, OnInit, ElementRef, ViewChild } from \"@angular/core\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { Converter } from \"showdown\";\nimport { StorageService } from \"../storage/storage.service\";\nimport { Item } from \"../storage/item\";\nimport { ModalComponent } from \"../modal/modal.component\";\n\n@Component({\n\tselector: \"bok-details\",\n\ttemplateUrl: \"./details.component.html\",\n\tstyleUrls: [\"./details.component.scss\"]\n})\nexport class DetailsComponent implements OnInit {\n\tprivate readonly converter: Converter = new Converter();\n\n\tprivate _loading: boolean = true;\n\tpublic get loading(): string {\n\t\treturn this._loading ? \"visible\" : \"hidden\";\n\t}\n\n\tprivate category: string;\n\tprivate name: string;\n\tprivate item: Item;\n\n\tprivate markdown: string;\n\n\t@ViewChild(\"article\")\n\tprivate article: ElementRef<HTMLElement>;\n\n\tpublic isEditing: boolean = false;\n\t\n\t//#region Add Image\n\t@ViewChild(\"addImage\")\n\tpublic addImage: ModalComponent;\n\tprivate selectedFile: File;\n\n\tprivate selectionNode: Node;\n\tprivate selectionOffset: number;\n\t//#endregion\n\n\tpublic constructor(private storage: StorageService, private route: ActivatedRoute) { }\n\n\tpublic async ngOnInit(): Promise<void> {\n\t\tthis.category = this.route.snapshot.params[\"category\"];\n\t\tthis.name = this.route.snapshot.params[\"name\"];\n\t\tthis.item = await this.storage.getItem(this.category, this.name);\n\n\t\tthis.markdown = await this.storage.downloadItemText(this.item);\n\t\tthis.article.nativeElement.innerHTML = this.converter.makeHtml(this.markdown);\n\n\t\tthis._loading = false;\n\t}\n\n\tpublic async toggleEditing(): Promise<void> {\n\t\tif (this.isEditing) {\n\t\t\tthis._loading = true;\n\n\t\t\tconst markdown: string = this.converter.makeMarkdown(this.article.nativeElement.innerHTML);\n\t\t\tif (this.markdown !== markdown) {\n\t\t\t\tconst success: boolean = await this.storage.updateDocument(this.item, markdown);\n\t\t\t}\n\n\t\t\tthis._loading = false;\n\t\t}\n\t\telse {\n\t\t\tdocument.execCommand(\"defaultParagraphSeparator\", false, \"p\");\n\t\t}\n\n\t\tthis.isEditing = !this.isEditing;\n\t}\n\n\tpublic makeHeader(): void {\n\t\tconst selection: Selection = getSelection();\n\n\t\tlet last: Node;\n\t\tlet current: Node = selection.anchorNode.parentNode;\n\t\twhile (current !== this.article.nativeElement) {\n\t\t\tlast = current;\n\t\t\tcurrent = current.parentNode;\n\t\t}\n\n\t\tswitch (last.nodeName) {\n\t\t\tcase \"P\":\n\t\t\tdefault:\n\t\t\t\tdocument.execCommand(\"formatBlock\", false, \"h1\");\n\t\t\t\tbreak;\n\t\t\tcase \"H1\":\n\t\t\t\tdocument.execCommand(\"formatBlock\", false, \"h2\");\n\t\t\t\tbreak;\n\t\t\tcase \"H2\":\n\t\t\t\tdocument.execCommand(\"formatBlock\", false, \"h3\");\n\t\t\t\tbreak;\n\t\t\tcase \"H3\":\n\t\t\t\tdocument.execCommand(\"formatBlock\", false, \"p\");\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tpublic makeBold(): void {\n\t\tdocument.execCommand(\"bold\");\n\t}\n\tpublic makeItalic(): void {\n\t\tdocument.execCommand(\"italic\");\n\t}\n\tpublic makeList(): void {\n\t\tdocument.execCommand(\"insertOrderedList\");\n\t}\n\tpublic makeBullets(): void {\n\t\tdocument.execCommand(\"insertUnorderedList\");\n\t}\n\tpublic makeImage(): void {\n\t\tconst selection: Selection = getSelection();\n\t\tthis.selectionNode = selection.anchorNode;\n\t\tthis.selectionOffset = selection.anchorOffset;\n\n\t\tthis.addImage.show();\n\t}\n\n\tpublic imageFileChange(files: FileList): void {\n\t\tif (files.length > 0) {\n\t\t\tthis.selectedFile = files[0];\n\t\t}\n\t}\n\tpublic addImageDone(status: boolean): void {\n\t\tif (status) {\n\t\t\tconst reader: FileReader = new FileReader();\n\t\t\treader.addEventListener(\n\t\t\t\t\"load\",\n\t\t\t\t() => {\n\t\t\t\t\tthis.article.nativeElement.focus();\n\t\t\t\t\tdocument.getSelection().setPosition(this.selectionNode, this.selectionOffset);\n\t\t\t\t\tdocument.execCommand(\"insertImage\", false, reader.result as string);\n\t\t\t\t},\n\t\t\t\tfalse\n\t\t\t);\n\t\t\treader.readAsDataURL(this.selectedFile);\n\t\t}\n\t}\n}","<progress [style.visibility]=\"loading\"></progress>\n\n<article>\n\t<button class=\"edit\" [class.noEdit]=\"isEditing\" (click)=\"toggleEditing()\" tool></button>\n\t<div #article [contentEditable]=\"isEditing\"></div>\n\t<aside>\n\t\t<button class=\"header\" (click)=\"makeHeader()\"></button>\n\t\t<button class=\"bold\" (click)=\"makeBold()\">F</button>\n\t\t<button class=\"italic\" (click)=\"makeItalic()\">K</button>\n\t\t<button class=\"list\" (click)=\"makeList()\"></button>\n\t\t<button class=\"bullets\" (click)=\"makeBullets()\"></button>\n\t\t<button class=\"image\" (click)=\"makeImage()\"></button>\n\t</aside>\n</article>\n\n<bok-modal #addImage\n           title=\"Lägg till bild\"\n           positive=\"Lägg till\"\n           negative=\"Avbryt\"\n           (close)=\"addImageDone($event)\">\n\t<label>\n\t\t<input type=\"file\" accept=\"image/*\" (change)=\"imageFileChange($event.target.files)\" modalRequired/>\n\t\t<div class=\"button\" data-choose=\"Välj bild\" data-change=\"Byt bild\"></div>\n\t</label>\n</bok-modal>","import { Injectable } from \"@angular/core\";\nimport { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot, Router } from \"@angular/router\";\nimport { Observable } from \"rxjs\";\nimport { StorageService } from \"../storage/storage.service\";\n\n@Injectable({\n\tprovidedIn: \"root\"\n})\nexport class IsSignedInGuard implements CanActivate {\n\tconstructor(private storage: StorageService, private router: Router) { }\n\n\tpublic canActivate(next: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\n\t\tif (this.storage.isLogedin()) {\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\tthis.router.navigate([\"/sign-in\"]);\n\t\t\treturn false;\n\t\t}\n\t}\n}","import { Injectable } from \"@angular/core\";\nimport { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot, Router } from \"@angular/router\";\nimport { Observable } from \"rxjs\";\nimport { StorageService } from \"../storage/storage.service\";\n\n@Injectable({\n\tprovidedIn: \"root\"\n})\nexport class IsSignedOutGuard implements CanActivate {\n\tconstructor(private storage: StorageService, private router: Router) { }\n\n\tpublic canActivate(next: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\n\t\tif (this.storage.isLogedin()) {\n\t\t\tthis.router.navigate([\"/\"]);\n\t\t\treturn false;\n\t\t}\n\t\telse {\n\t\t\treturn true;\n\t\t}\n\t}\n}","import { Directive, Input, ElementRef, HostListener } from \"@angular/core\";\n\n@Directive({\n\t// tslint:disable-next-line:directive-selector\n\tselector: \"[modalRequired]\"\n})\nexport class ModalRequiredDirective {\n\tprivate _isValid: boolean = false;\n\n\t@HostListener(\"input\")\n\tprivate onInput(): void {\n\t\tthis._isValid = this.host.nativeElement.validity.valid;\n\t}\n\n\tpublic constructor(private host: ElementRef<HTMLInputElement>) {\n\t\tthis.host.nativeElement.required = true;\n\t}\n\n\tpublic isValid(): boolean {\n\t\treturn this._isValid;\n\t}\n}","import { Component, Input, HostBinding, Output, EventEmitter, ContentChildren, QueryList } from \"@angular/core\";\nimport { ModalRequiredDirective } from \"./modal-required.directive\";\n\n@Component({\n\tselector: \"bok-modal\",\n\ttemplateUrl: \"./modal.component.html\",\n\tstyleUrls: [\"./modal.component.scss\"]\n})\nexport class ModalComponent {\n\t@Input()\n\tpublic title: string;\n\t@Input()\n\tpublic positive: string;\n\t@Input()\n\tpublic negative: string;\n\n\t@Output()\n\tpublic close: EventEmitter<boolean> = new EventEmitter<boolean>();\n\n\t@HostBinding(\"style.display\")\n\tprivate styleDisplay: string = \"none\";\n\tprivate get visible(): boolean {\n\t\treturn this.styleDisplay !== \"none\";\n\t}\n\tprivate set visible(value: boolean) {\n\t\tthis.styleDisplay = value ? \"\" : \"none\";\n\t}\n\n\t@ContentChildren(ModalRequiredDirective)\n\tprivate required: QueryList<ModalRequiredDirective>;\n\n\tpublic constructor() { }\n\n\tpublic isAllValid(): boolean {\n\t\treturn this.required.toArray().every(x => x.isValid());\n\t}\n\n\tpublic show(): void {\n\t\tthis.visible = true;\n\t}\n\n\tpublic hide(status: boolean): void {\n\t\tthis.visible = false;\n\t\tthis.close.emit(status);\n\t}\n}","<div>\n\t<div class=\"top\">\n\t\t<h1 *ngIf=\"title\">{{title}}</h1>\n\t</div>\n\t<div class=\"content\">\n\t\t<ng-content></ng-content>\n\t</div>\n\t<div class=\"bottom\">\n\t\t<button *ngIf=\"negative\" (click)=\"hide(false);\" class=\"cancel\">{{negative}}</button>\n\t\t<button *ngIf=\"positive\" (click)=\"hide(true);\" class=\"ok\" [disabled]=\"!isAllValid()\">{{positive}}</button>\n\t</div>\n</div>","import { Injectable } from \"@angular/core\";\nimport { Router, NavigationEnd, RouterEvent } from \"@angular/router\";\n\n@Injectable({\n\tprovidedIn: \"root\"\n})\nexport class RoutingStateService {\n\tprivate history: Array<string> = new Array<string>();\n\n\tpublic constructor(private router: Router) {\n\t\tthis.router.events.subscribe(\n\t\t\t(e: RouterEvent) => {\n\t\t\t\tif (e instanceof NavigationEnd) {\n\t\t\t\t\tif (e.urlAfterRedirects === this.history[this.history.length - 2]) {\n\t\t\t\t\t\tthis.history.pop();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.history.push(e.urlAfterRedirects);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic getPreviousUrl(): string {\n\t\treturn this.history[this.history.length - 2] || \"/\";\n\t}\n\n\tpublic hasHistory(): boolean {\n\t\treturn this.history.length > 1;\n\t}\n}","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'bok-settings',\n  templateUrl: './settings.component.html',\n  styleUrls: ['./settings.component.scss']\n})\nexport class SettingsComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<p>\n  settings works!\n</p>\n","import { Component } from \"@angular/core\";\nimport { StorageService } from \"../storage/storage.service\";\nimport { Router } from \"@angular/router\";\n\n@Component({\n\tselector: \"bok-sign-in\",\n\ttemplateUrl: \"./sign-in.component.html\",\n\tstyleUrls: [\"./sign-in.component.scss\"]\n})\nexport class SignInComponent {\n\tconstructor(private storage: StorageService, private router: Router) { }\n\n\tpublic async signin(): Promise<void> {\n\t\tawait this.storage.signin();\n\t\tthis.router.navigate([\"/\"]);\n\t}\n}","<button (click)=\"signin()\">Logga in med OneDrive</button>","<progress [style.visibility]=\"loading\"></progress>\n<div>\n\t<button class=\"item\" *ngFor=\"let category of categories\" [routerLink]=\"'/recept/' + category.name\">\n\t\t<span>{{category.name}}</span>\n\t\t<button (click)=\"$event.stopImmediatePropagation(); edit(category);\"></button>\n\t</button>\n\t<a class=\"item new\" (click)=\"addNew()\"></a>\n</div>\n\n<bok-modal #addModal\n           title=\"Ny kategori\"\n           positive=\"Skapa\"\n           negative=\"Avbryt\"\n           (close)=\"addNewDone($event)\">\n\t<input type=\"text\" placeholder=\"Namn\" [(ngModel)]=\"addingName\" modalRequired/>\n</bok-modal>\n\n<bok-modal #editModal\n           [title]=\"_editingTitle\"\n           positive=\"Spara\"\n           negative=\"Avbryt\"\n           (close)=\"editDone($event)\">\n\t<input type=\"text\" placeholder=\"Namn\" [(ngModel)]=\"_editingTitleBox\">\n\t<button class=\"delete\" (click)=\"editDelete()\">Ta bort</button>\n</bok-modal>","import { Component, OnInit, ViewChild } from \"@angular/core\";\nimport { StorageService } from \"../storage/storage.service\";\nimport { Category } from \"../storage/category\";\nimport { ModalComponent } from \"../modal/modal.component\";\n\n@Component({\n\tselector: \"bok-start\",\n\ttemplateUrl: \"./start.component.html\",\n\tstyleUrls: [\"./start.component.scss\"]\n})\nexport class StartComponent implements OnInit {\n\tpublic categories: Array<Category>;\n\n\t//#region Edit Modal\n\t@ViewChild(\"editModal\")\n\tpublic editModal: ModalComponent;\n\n\tprivate editingCategory: Category;\n\tpublic _editingTitle: string;\n\tpublic _editingTitleBox: string;\n\tprivate set editingTitle(value: string) {\n\t\tthis._editingTitle = value;\n\t\tthis._editingTitleBox = value;\n\t}\n\tprivate get editingTitle(): string {\n\t\treturn this._editingTitleBox;\n\t}\n\t//#endregion\n\n\t//#region Add Modal\n\t@ViewChild(\"addModal\")\n\tpublic addModal: ModalComponent;\n\n\tpublic addingName: string;\n\tpublic addingType: number = 0;\n\tpublic addingURL: string;\n\t//#endregion\n\n\tprivate isLoading: boolean = false;\n\tpublic get loading(): string {\n\t\treturn (this.categories === undefined || this.isLoading) ? \"visible\" : \"hidden\";\n\t}\n\n\tpublic constructor(private storage: StorageService) { }\n\n\tpublic async ngOnInit() {\n\t\tthis.categories = await this.storage.getCategories();\n\t}\n\n\tpublic edit(category: Category): void {\n\t\tthis.editingCategory = category;\n\t\tthis.editingTitle = category.name;\n\t\tthis.editModal.show();\n\t}\n\tpublic async editDelete(): Promise<void> {\n\t\t// Delete this.editingID\n\t\tthis.editModal.hide(false);\n\n\t\tthis.isLoading = true;\n\n\t\tconst success: boolean = await this.storage.categoryDelete(this.editingCategory.id);\n\t\tif (success) {\n\t\t\tthis.categories = this.categories.filter(x => x.id !== this.editingCategory.id);\n\t\t}\n\n\t\tthis.isLoading = false;\n\t}\n\tpublic async editDone(status: boolean): Promise<void> {\n\t\tif (status) {\n\t\t\tthis.isLoading = true;\n\n\t\t\tconst success: boolean = await this.storage.categoryRename(this.editingCategory.id, this.editingTitle);\n\t\t\tif (success) {\n\t\t\t\tthis.editingCategory.name = this.editingTitle;\n\t\t\t}\n\n\t\t\tthis.isLoading = false;\n\t\t}\n\t}\n\n\tpublic addNew(): void {\n\t\tthis.addingName = \"\";\n\n\t\tthis.addModal.show();\n\t}\n\tpublic async addNewDone(status: boolean): Promise<void> {\n\t\tif (status) {\n\t\t\tthis.isLoading = true;\n\n\t\t\ttry {\n\t\t\t\tconst newCategory: Category = await this.storage.addCategory(this.addingName);\n\t\t\t\tthis.categories.push(newCategory);\n\t\t\t\tthis.categories = this.categories.sort(\n\t\t\t\t\t(a, b) => {\n\t\t\t\t\t\tconst aName = a.name.toLowerCase();\n\t\t\t\t\t\tconst bName = b.name.toLowerCase();\n\n\t\t\t\t\t\tif (aName < bName) {\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (aName > bName) {\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tcatch (error) {\n\t\t\t\tconsole.error(\"Could not add URL:\", error);\n\t\t\t}\n\n\t\t\tthis.isLoading = false;\n\t\t}\n\t}\n}","import { ResponseItem } from \"./response\";\n\nexport class Category {\n\tpublic static async ExtractFromData(data: ResponseItem): Promise<Category> {\n\t\tif (data.hasOwnProperty(\"folder\")) {\n\t\t\treturn new Category(data.id, data.createdDateTime, data.name);\n\t\t}\n\t\telse {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tpublic readonly id: string;\n\tpublic readonly created: Date;\n\tpublic name: string;\n\n\tpublic constructor(id: string, created: string, name: string) {\n\t\tthis.id = id;\n\t\tthis.created = new Date(created);\n\t\tthis.name = name;\n\t}\n}","import { ResponseItem } from \"./response\";\nimport { Category } from \"./category\";\n\nexport class Item extends Category {\n\tpublic static async ExtractFromData(data: ResponseItem): Promise<Item> {\n\t\tif (data.hasOwnProperty(\"file\") &&\n\t\t\tdata.hasOwnProperty(\"@microsoft.graph.downloadUrl\")) {\n\t\t\treturn new Item(data.id, data.createdDateTime, data.name, data[\"@microsoft.graph.downloadUrl\"]);\n\t\t}\n\t\telse {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tpublic readonly type: string;\n\tpublic readonly link: string;\n\n\tpublic constructor(id: string, created: string, name: string, link?: string) {\n\t\tsuper(id, created, name.substring(0, name.lastIndexOf(\".\")));\n\t\tthis.type = name.substring(name.lastIndexOf(\".\") + 1);\n\t\tthis.link = link || this.name;\n\t}\n}","import { Injectable } from \"@angular/core\";\nimport { HttpClient } from \"@angular/common/http\";\nimport { Response, ResponseItem } from \"./response\";\nimport { Category } from \"./category\";\nimport { Item } from \"./item\";\n\ndeclare const Msal: any;\n\n@Injectable({\n\tprovidedIn: \"root\"\n})\nexport class StorageService {\n\tprivate static readonly clientID: string = \"8d45faf8-ac8b-4dc5-98b4-2f0aa0703deb\";\n\tprivate static readonly authority: string = \"https://login.microsoftonline.com/common\";\n\tprivate static readonly scopes: Array<string> = [ \"user.read\", \"files.readwrite\" ];\n\tprivate static readonly base: string = \"https://graph.microsoft.com/v1.0/me/drive\";\n\tprivate static get Scopes(): Array<string> { return StorageService.scopes.map(x => \"https://graph.microsoft.com/\" + x); }\n\tprivate static get Approot(): string { return StorageService.base + \"/special/approot\"; }\n\tprivate static get Items(): string { return StorageService.base + \"/items\"; }\n\n\tprivate readonly msalAgent: any;\n\tprivate token: Promise<string>;\n\n\tpublic constructor(private http: HttpClient) {\n\t\tthis.msalAgent = new Msal.UserAgentApplication(\n\t\t\tStorageService.clientID,\n\t\t\tnull,\n\t\t\tthis.tokenReceivedCallback,\n\t\t\t{\n\t\t\t\tstoreAuthStateInCookie: true,\n\t\t\t\tcacheLocation: \"localStorage\",\n\t\t\t\tredirectUri: \"https://kokbok.app/sign-in\"\n\t\t\t}\n\t\t);\n\n\t\tif (this.isLogedin()) {\n\t\t\tthis.acquireToken();\n\t\t}\n\t}\n\n\tprivate tokenReceivedCallback(errorDesc: any, token: any, error: any, tokenType: any): void {\n\t\tconsole.error(\"tokenReceivedCallback\", errorDesc, token, error, tokenType);\n\t}\n\n\tprivate async acquireToken(): Promise<string> {\n\t\tif (this.token == null) {\n\t\t\tconst fetchToken = async (): Promise<string> => {\n\t\t\t\ttry {\n\t\t\t\t\treturn await this.msalAgent.acquireTokenSilent(StorageService.Scopes);\n\t\t\t\t}\n\t\t\t\tcatch (error) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconsole.log(\"try\", error);\n\t\t\t\t\t\treturn await this.msalAgent.acquireTokenPopup(StorageService.Scopes);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (error) {\n\t\t\t\t\t\tconsole.log(\"failed\", error);\n\t\t\t\t\t\tthrow new Error(\"Can't signin\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.token = fetchToken();\n\t\t}\n\n\t\treturn await this.token;\n\t}\n\n\tprivate async getOptions(): Promise<{ headers: { Authorization: string } }> {\n\t\treturn {\n\t\t\theaders: {\n\t\t\t\t\"Authorization\": \"Bearer \" + await this.acquireToken()\n\t\t\t}\n\t\t};\n\t}\n\n\tpublic isLogedin(): boolean {\n\t\treturn this.msalAgent.getUser() != null;\n\t}\n\n\tpublic async signin(): Promise<void> {\n\t\ttry {\n\t\t\tawait this.msalAgent.loginPopup(StorageService.Scopes);\n\n\t\t\tawait this.acquireToken();\n\t\t}\n\t\tcatch (error) {\n\t\t\tconsole.log(\"Signin error\", error);\n\t\t}\n\t}\n\n\tpublic async signout(): Promise<void> {\n\t\twindow.localStorage.clear();\n\t}\n\n\tprivate async makeGet<T>(URL: string): Promise<T> {\n\t\tconst response: T = await this.http.get<T>(URL, await this.getOptions()).toPromise<T>();\n\n\t\treturn response;\n\t}\n\n\tpublic async getCategories(): Promise<Array<Category>> {\n\t\tconst resopnse: Response = await this.makeGet<Response>(StorageService.Approot + \"/children\");\n\n\t\tconst arr: Array<Category> = new Array<Category>();\n\n\t\tfor (const data of resopnse.value) {\n\t\t\tconst cat: Category = await Category.ExtractFromData(data);\n\t\t\tif (cat != null) {\n\t\t\t\tarr.push(cat);\n\t\t\t}\n\t\t}\n\n\t\treturn arr;\n\t}\n\tpublic async getItems(category: string): Promise<Array<Item>> {\n\t\tconst resopnse: Response = await this.makeGet<Response>(StorageService.Approot + \":/\" + category + \":/children\");\n\t\tconst arr: Array<Item> = new Array<Item>();\n\n\t\tfor (const data of resopnse.value) {\n\t\t\tconst item = await this.createItem(data);\n\t\t\tif (item != null) {\n\t\t\t\tarr.push(item);\n\t\t\t}\n\t\t}\n\n\t\treturn arr;\n\t}\n\tpublic async getItem(category: string, name: string): Promise<Item> {\n\t\tconst items: Array<Item> = await this.getItems(category);\n\n\t\tfor (const item of items) {\n\t\t\tif (item.name === name) {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\t}\n\tprivate async createItem(data: ResponseItem) {\n\t\tlet item: Item = await Item.ExtractFromData(data);\n\t\tif (item != null) {\n\t\t\tif (item.type === \"url\") {\n\t\t\t\titem = await this.downloadLink(item);\n\t\t\t}\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tpublic async itemRename(id: string, newName: string): Promise<boolean> {\n\t\ttry {\n\t\t\tawait this.http.patch(\n\t\t\t\tStorageService.Items + \"/\" + id,\n\t\t\t\t{\n\t\t\t\t\t\"name\": newName\n\t\t\t\t},\n\t\t\t\tawait this.getOptions()\n\t\t\t).toPromise();\n\t\t}\n\t\tcatch {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\tpublic async itemDelete(id: string): Promise<boolean> {\n\t\ttry {\n\t\t\tawait this.http.delete(\n\t\t\t\tStorageService.Items + \"/\" + id,\n\t\t\t\tawait this.getOptions()\n\t\t\t).toPromise();\n\t\t}\n\t\tcatch {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tpublic async categoryRename(id: string, newName: string): Promise<boolean> {\n\t\ttry {\n\t\t\tawait this.http.patch(\n\t\t\t\tStorageService.Items + \"/\" + id,\n\t\t\t\t{\n\t\t\t\t\t\"name\": newName\n\t\t\t\t},\n\t\t\t\tawait this.getOptions()\n\t\t\t).toPromise();\n\n\t\t\treturn true;\n\t\t}\n\t\tcatch {\n\t\t\treturn false;\n\t\t}\n\t}\n\tpublic async categoryDelete(id: string): Promise<boolean> {\n\t\ttry {\n\t\t\tawait this.http.delete(\n\t\t\t\tStorageService.Items + \"/\" + id,\n\t\t\t\tawait this.getOptions()\n\t\t\t).toPromise();\n\t\t}\n\t\tcatch {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate async addItem(category: string, name: string, content: string): Promise<Item> {\n\t\tconst response: ResponseItem = await this.http.put<ResponseItem>(\n\t\t\tStorageService.Approot + \":/\" + category + \"/\" + name + \":/content\",\n\t\t\tcontent,\n\t\t\tawait this.getOptions()\n\t\t).toPromise<ResponseItem>();\n\n\t\treturn await this.createItem(response);\n\t}\n\tpublic async addItemURL(category: string, name: string, URL: string): Promise<Item> {\n\t\treturn await this.addItem(category, name + \".url\", \"[InternetShortcut]\\nURL=\" + URL);\n\t}\n\tpublic async addItemDocument(category: string, name: string): Promise<Item> {\n\t\treturn await this.addItem(category, name + \".md\", \"# \" + name);\n\t}\n\n\tpublic async addCategory(name: string): Promise<Category> {\n\t\tconst response: ResponseItem = await this.http.post<ResponseItem>(\n\t\t\tStorageService.Approot + \"/children\",\n\t\t\t{\n\t\t\t\t\"name\": name,\n\t\t\t\t\"folder\": { },\n\t\t\t\t\"@microsoft.graph.conflictBehavior\": \"rename\"\n\t\t\t},\n\t\t\tawait this.getOptions()\n\t\t).toPromise<ResponseItem>();\n\n\t\treturn Category.ExtractFromData(response);\n\t}\n\n\tpublic async updateDocument(item: Item, content: string): Promise<boolean> {\n\t\tif (item.type === \"md\") {\n\t\t\ttry {\n\t\t\t\tawait this.uploadDocument(item.id, content);\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcatch {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate uploadDocument(id: string, content: string): Promise<void> {\n\t\tconst uploadSmallDocument = async (id: string, content: string): Promise<void> => {\n\t\t\tawait this.http.put(\n\t\t\t\tStorageService.Items + \"/\" + id + \"/content\",\n\t\t\t\tcontent,\n\t\t\t\tawait this.getOptions()\n\t\t\t).toPromise();\n\t\t};\n\t\tconst uploadBigDocument = async (id: string, content: string): Promise<void> => {\n\t\t\tconst uploadPart = async (url: string, blob: Blob, index: number, total: number): Promise<void> => {\n\t\t\t\tawait this.http.put(\n\t\t\t\t\turl,\n\t\t\t\t\tawait blob.text(),\n\t\t\t\t\t{\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\"Content-Range\": `bytes ${index}-${Math.min(index + blob.size, total) - 1}/${total}`\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).toPromise();\n\t\t\t};\n\n\t\t\tconst response = await this.http.post(\n\t\t\t\tStorageService.Items + \"/\" + id + \"/createUploadSession\",\n\t\t\t\t{\n\t\t\t\t\t\"@microsoft.graph.conflictBehavior\": \"replace\"\n\t\t\t\t},\n\t\t\t\tawait this.getOptions()\n\t\t\t).toPromise();\n\t\t\tif (response != null && \"uploadUrl\" in response) {\n\t\t\t\tconst blob = new Blob([content]);\n\t\t\t\tconst partSize = 327680 * 20;\n\t\t\t\tfor (let i = 0; i < blob.size; i += partSize) {\n\t\t\t\t\tawait uploadPart(response[\"uploadUrl\"], blob.slice(i, i + partSize), i, blob.size);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthrow new Error(\"Could not fetch upload URL.\");\n\t\t\t}\n\t\t};\n\n\t\tif (content.length < 4000000) {\n\t\t\treturn uploadSmallDocument(id, content);\n\t\t}\n\t\telse {\n\t\t\treturn uploadBigDocument(id, content);\n\t\t}\n\t}\n\n\tpublic async downloadItemText(item: Item): Promise<string> {\n\t\treturn await this.http.get<string>(\n\t\t\titem.link,\n\t\t\t{\n\t\t\t\tresponseType: \"text\" as \"json\"\n\t\t\t}\n\t\t).toPromise<string>();\n\t}\n\tprivate async downloadLink(item: Item): Promise<Item> {\n\t\tlet linkText: string = await this.downloadItemText(item);\n\n\t\tlinkText = linkText.replace(/(.|\\n|\\r)*?URL=(.*)(.|\\n|\\r)*/ig, \"$2\");\n\n\t\treturn new Item(item.id, item.created.toISOString(), item.name + \".\" + item.type, linkText);\n\t}\n}","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n\tproduction: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import \"zone.js/dist/zone-error\";  // Included with Angular CLI.\n","import { enableProdMode } from \"@angular/core\";\nimport { platformBrowserDynamic } from \"@angular/platform-browser-dynamic\";\n\nimport { AppModule } from \"./app/app.module\";\nimport { environment } from \"./environments/environment\";\n\nif (environment.production) {\n\tenableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n\t.catch(err => console.error(err));\n"]}